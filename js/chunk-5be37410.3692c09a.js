(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5be37410"],{"00df":function(t,e,a){"use strict";a("9e53")},"00e4":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.dialogVisible?a("div",{staticClass:"overlay-p"},[a("div",{staticClass:"dialog"},[a("div",{staticClass:"title",on:{click:t.closeDialog}},[t._v("×")]),a("div",{staticClass:"msg-box"},[a("div",{staticClass:"msg"},[t._v("请输入支付密码")]),a("div",{staticClass:"price"},[t._v("付款"+t._s(t.order_money)+"元")]),t.err_flag?a("div",{staticClass:"err-msg",class:{animition:!0}},[t._v(" "+t._s("p_error"===t.err_flag?"支付密码不正确":"余额不足")+" ")]):t._e()]),a("van-password-input",{attrs:{value:t.password_value,focused:t.showKeyboard,length:6},on:{focus:function(e){t.showKeyboard=!0}}}),a("loading",{directives:[{name:"show",rawName:"v-show",value:t.payLoading,expression:"payLoading"}],attrs:{loadingType:4,paySuccess:t.paySuccess}})],1),a("van-number-keyboard",{attrs:{maxlength:"6","hide-on-click-outside":!1,show:t.showKeyboard,"safe-area-inset-bottom":!1},on:{blur:function(e){t.showKeyboard=!0}},model:{value:t.password_value,callback:function(e){t.password_value=e},expression:"password_value"}})],1):t._e()},r=[],i=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),o=a("bf93"),n={components:{Loading:o["a"]},props:{dialogVisible:{type:Boolean,default:!1},order_id:{type:String},order_money:{default:0}},data:function(){return{password_value:"",showKeyboard:!0,paySuccess:!1,payLoading:!1,err_flag:null}},methods:{closeDialog:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.err_flag=null,this.password_value="",this.paySuccess=!1,this.$emit("changeDialog",e)},validPassword:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.err_flag=null,a=new URLSearchParams,a.append("orderId",t.order_id),a.append("userToken",t.$store.state.token),a.append("password",t.password_value),e.next=7,t.$http.post("/user/postPayOrderServlet",a);case 7:s=e.sent,r=s.data,"000000"===r.messageStatus?(setTimeout((function(){t.paySuccess=!0}),800),setTimeout((function(){t.payLoading=!1,t.closeDialog("_",!0)}),2300)):setTimeout((function(){t.paySuccess=!1,t.payLoading=!1,t.password_value="","123456"===r.messageStatus?t.err_flag="p_error":"654321"===r.messageStatus?t.err_flag="price_not":t.$toast(r.error)}),800);case 10:case"end":return e.stop()}}),e)})))()}},watch:{password_value:function(t){6===t.length&&(this.payLoading=!0,this.validPassword())}}},d=n,c=(a("b72a"),a("2877")),l=Object(c["a"])(d,s,r,!1,null,null,null);e["a"]=l.exports},1e3:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detail"},[a("nav-bar",{attrs:{title:"订单详情",link:t.link}}),[a("div",{staticClass:"od-header"},[a("div",{staticStyle:{"margin-top":"50px","margin-bottom":"20px"}},[a("div",{staticClass:"od-status"},[a("span",{staticClass:"od-icon"},["complte"===t.data.orderStatus?a("van-icon",{staticClass:"success",attrs:{name:"checked"}}):"payComplte"===t.data.orderStatus?a("van-icon",{staticClass:"success",attrs:{name:"smile"}}):a("van-icon",{staticClass:"warning",attrs:{name:"underway"}})],1),a("div",{staticClass:"od-msg"},["complte"===t.data.orderStatus?[a("p",[t._v("订单已完成")]),a("span",[t._v("感谢您的购买")])]:"holdPay"===t.data.orderStatus?[a("p",[t._v("订单未支付")]),a("span",[t._v("超时将自动取消")])]:"payComplte"===t.data.orderStatus?[a("p",[t._v("订单已支付")]),a("span",[t._v("请等待配送")])]:"distribution"===t.data.orderStatus?[a("p",[t._v("订单配送中")]),a("span",[t._v("配送中无法取消")])]:a("div",[t._v("状态未知")])],2)]),t.time||t.time>0?a("div",{staticClass:"order-time"},[a("van-count-down",{attrs:{millisecond:"",time:t.time,format:"mm分ss秒"},on:{finish:t.finish}}),t._v(" 后将自动取消订单 ")],1):t._e()]),a("div",{staticClass:"od-group"},["complte"===t.data.orderStatus||"distribution"===t.data.orderStatus?a("a",{staticClass:"order-center",attrs:{href:"tel:18888888888"}},[t._v("联系客服")]):a("a",{staticClass:"cancel",attrs:{href:"javascript:void(0);"},on:{click:t.handelCancel}},[t._v("取消订单")]),"holdPay"===t.data.orderStatus&&t.takeway?a("a",{staticClass:"ap1",attrs:{href:"javascript:void(0);"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("立即支付")]):t._e(),"holdPay"===t.data.orderStatus||t.takeway_shop?t._e():a("a",{staticClass:"continue",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.goIndex(0)}}},[t._v("继续下单")])])]),a("div",{staticClass:"od-content"},[a("div",{staticClass:"order-food"},[a("div",{staticClass:"od-shop"},[t._v("佚鲜餐厅—"+t._s(t.data.tableNumber))]),a("div",{staticClass:"content-box"},[a("div",{class:{"content-down":!t.flag,"content-up":t.flag}},[a("foodItem",{attrs:{food:t.data.listArray,setStyle:"o-food-item"}})],1),t.data.listArray?[t.data.listArray.length>3?a("div",{staticClass:"toggle",on:{click:function(e){t.flag=!t.flag}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.flag,expression:"!flag"}]},[t._v("展示更多"),a("van-icon",{attrs:{name:"arrow-down"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}]},[t._v("点击收起"),a("van-icon",{attrs:{name:"arrow-up"}})],1)]):t._e()]:t._e()],2),a("div",{staticClass:"od-price"},[t._v(" 实付: "),a("span",[t._v("￥"+t._s(t.data.orderPice))])])]),a("div",{staticClass:"order-info"},[a("div",{staticClass:"title"},[t._v("订单信息")]),t._m(0),a("div",{staticClass:"item"},[a("p",[t._v("下单时间")]),a("span",[t._v(t._s(t._f("dateFormat")(t.data.orderTime)))])]),t.data.orderRemarks?a("div",{staticClass:"item"},[a("p",[t._v("订单备注")]),a("span",[t._v(t._s(t.data.orderRemarks))])]):t._e()])])],t.isLoading?a("loading",{attrs:{loadingType:1}}):t._e(),a("pay-dialog",{attrs:{dialogVisible:t.dialogVisible,order_id:t.order_id,order_money:t.money},on:{changeDialog:t.changeDialog}})],2)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item"},[a("p",[t._v("支付方式")]),a("span",[t._v("无需付款")])])}],i=(a("a9e3"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("9911"),a("ddb0"),a("2b3d"),a("5530")),o=(a("96cf"),a("1da1")),n=a("00e4"),d=a("bf93"),c=a("d968"),l=a("92fe"),u=a("2f62"),p={components:{NavBar:c["a"],foodItem:l["a"],Loading:d["a"],PayDialog:n["a"]},data:function(){return{isLoading:!0,flag:!1,dialogVisible:!1,money:0,order_id:"",data:[],link:"/",orderType:"forHere",time:null}},created:function(){this.order_id=this.$route.query.o_id,this.queryInfo()},methods:{finish:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"订单已取消";this.$toast(t),this.$router.go(-1)},goIndex:function(t){if("/"===this.link)this.$store.commit("checkTab",t),this.$router.replace({path:"/index",query:{shop_id:this.shopId}});else{var e="/order";t||(e="/home"),this.$router.replace(e)}},queryInfo:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.takeway){e.next=3;break}if(t.token){e.next=3;break}return e.abrupt("return",t.$router.replace("/home"));case 3:return a=new URLSearchParams,a.append("orderId",t.order_id),t.takeway&&(t.orderType="takeOut",a.append("userToken",t.token)),a.append("orderType",t.orderType),e.next=9,t.$http.post("user/postSelectOrderMessageByUserId",a);case 9:if(s=e.sent,r=s.data,"000000"!==r.messageStatus){e.next=21;break}if(t.data=r,t.money=r.orderPice,t.time=r.timeOut?1e3*(Number(r.timeOut)+1):null,!(t.time<0)){e.next=18;break}return t.time=null,e.abrupt("return",t.finish("订单超时未支付已自动取消"));case 18:"takeOut"===r.orderType&&(t.link="/order"),e.next=23;break;case 21:t.$toast("订单查询失败"),t.$router.go(-1);case 23:t.isLoading=!1;case 24:case"end":return e.stop()}}),e)})))()},handelCancel:function(){if(!this.takeway)return this.$toast("堂食暂不能取消");this.$confirm({title:"提示",message:"确定取消订单吗?",beforeClose:this.cancelOrder})},cancelOrder:function(t,e){var a=this;if(console.log(1),"confirm"===t){var s=new URLSearchParams;s.append("userToken",this.token),s.append("orderId",this.data.orderId),setTimeout(Object(o["a"])(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.$http.post("/user/postCancelOrderByUserId",s);case 2:r=t.sent,i=r.data,e(),"000000"===i.messageStatus?a.$toast("订单已取消"):a.$toast(i.error),a.$router.back();case 7:case"end":return t.stop()}}),t)}))),800)}else e()},changeDialog:function(t){t&&(this.isLoading=!0,this.queryInfo()),this.dialogVisible=!1}},computed:Object(i["a"])({},Object(u["d"])(["token","takeway","takeway_shop","shopId"])),beforeRouteEnter:function(t,e,a){t.query.o_id?a():a(!1)}},v=p,f=(a("fedb"),a("2877")),h=Object(f["a"])(v,s,r,!1,null,"21209364",null);e["default"]=h.exports},"4f5e":function(t,e,a){},"832d":function(t,e,a){},"857a":function(t,e,a){var s=a("1d80"),r=/"/g;t.exports=function(t,e,a,i){var o=String(s(t)),n="<"+e;return""!==a&&(n+=" "+a+'="'+String(i).replace(r,"&quot;")+'"'),n+">"+o+"</"+e+">"}},9911:function(t,e,a){"use strict";var s=a("23e7"),r=a("857a"),i=a("af03");s({target:"String",proto:!0,forced:i("link")},{link:function(t){return r(this,"a","href",t)}})},"9e53":function(t,e,a){},af03:function(t,e,a){var s=a("d039");t.exports=function(t){return s((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},b72a:function(t,e,a){"use strict";a("4f5e")},d968:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav"},[a("div",{staticClass:"b"},[a("van-icon",{staticClass:"nav-arrow-left",attrs:{name:"arrow-left"},on:{click:t.navigator}}),a("div",{staticClass:"nav-title"},[t._v(t._s(t.title))])],1)])},r=[],i=(a("ac1f"),a("5319"),a("9911"),{props:["title","link","location_search_id"],methods:{navigator:function(){"/"===this.link?this.$router.go(-1):"/index"===this.link?this.location_search_id?this.$router.replace({path:"/index"+this.location_search_id}):this.$router.replace({path:"/index",query:{shop_id:this.$store.state.shopId}}):"/mine"===this.link?this.$router.replace(this.link):this.$router.go(-1)}}}),o=i,n=(a("00df"),a("2877")),d=Object(n["a"])(o,s,r,!1,null,"93c629b4",null);e["a"]=d.exports},fedb:function(t,e,a){"use strict";a("832d")}}]);