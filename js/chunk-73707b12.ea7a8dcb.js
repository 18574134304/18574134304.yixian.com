(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73707b12"],{"00df":function(t,e,o){"use strict";o("9e53")},1068:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"q-page"},[o("navBar",{attrs:{title:"搜索菜品"}}),o("div",{staticClass:"query"},[o("div",{staticClass:"box"},[o("svg",{staticClass:"icon search-icon",attrs:{"aria-hidden":"true"}},[o("use",{attrs:{"xlink:href":"#icon-sousuo"}})]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{autofocus:"",autocomplete:"off",autocorrect:"off",type:"text",placeholder:"想吃什么搜一搜"},domProps:{value:t.value},on:{input:[function(e){e.target.composing||(t.value=e.target.value)},t.handelInput]}}),o("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"clear-icon",attrs:{name:"cross"},on:{click:function(e){t.value=""}}})],1)]),o("div",{staticClass:"content"},[o("div",{directives:[{name:"show",rawName:"v-show",value:!t.value&&t.stroage,expression:"!value && stroage"}],staticClass:"stroage"},[o("div",{staticClass:"stroage-header"},[o("span",[t._v("历史搜索")]),o("van-icon",{staticClass:"clear-stroage",attrs:{name:"delete-o"},on:{click:t.clearStorage}})],1),o("div",{staticClass:"stroage-content"},t._l(t.stroage,(function(e,a){return o("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(o){t.value=e}}},[t._v(t._s(e))])})),0)]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],ref:"queryScroll",staticClass:"box"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.data.length,expression:"data.length"}],staticClass:"food-content"},[o("food-item",{attrs:{food:t.data},on:{handelFocus:t.showKey}})],1),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.data.length,expression:"!data.length"}],staticClass:"msg"},[o("p",[t._v("该商店内没有相关的商品哦~")]),o("span",[t._v("更多商品开发中，敬请期待")])]),o("loading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],attrs:{loadingType:2}})],1)]),o("key-board",{attrs:{key_flag:t.show,item:t.item},on:{onHide:t.closeKey}}),o("shopCart",{directives:[{name:"show",rawName:"v-show",value:t.data.length&&t.fot_falg,expression:"data.length && fot_falg"}]})],1)},s=[],i=(o("4de4"),o("4160"),o("c975"),o("d3b7"),o("ac1f"),o("3ca3"),o("5319"),o("159b"),o("ddb0"),o("2b3d"),o("96cf"),o("1da1")),n=o("5530"),r=o("d968"),c=o("6d9e"),l=o("bf93"),u=o("92fe"),d=o("653e"),h=o("2f62"),f={components:{navBar:r["a"],loading:l["a"],foodItem:u["a"],shopCart:d["a"],keyBoard:c["a"]},data:function(){return{value:"",data:[],isLoading:!1,show:!1,fot_falg:!0,item:{},stroage:null,timer:null,f_height:document.documentElement.clientHeight,t_height:document.documentElement.clientHeight}},methods:Object(n["a"])(Object(n["a"])({},Object(h["c"])(["setFood"])),{},{getCart:function(){var t=JSON.parse(localStorage.cart),e=[];t.filter((function(t){return e.push(t.foodId)})),this.$store.state.foodList=t,this.food.forEach((function(o){-1!=e.indexOf(o.foodId)?o.foodNumber=t[e.indexOf(o.foodId)].foodNumber:o.foodNumber=0}))},query:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var o,a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=new URLSearchParams,a=t.$route.query.shop_id,a?o.append("shopId",a):o.append("shopId",t.$store.state.shopId),o.append("userToken",""),e.next=6,t.$http.post("/user/postSelectFoodAndTypeByUserInShop",o);case 6:s=e.sent,i=s.data,t.setFood(i),t.getCart();case 10:case"end":return e.stop()}}),e)})))()},showKey:function(t){this.item=t,this.show=!0},closeKey:function(t){this.show=t},handelInput:function(){this.value=this.value.replace(/\s/g,"")},getSearchFood:function(){var t=this;this.data=[],this.isLoading&&(this.isLoading=!1),this.isLoading=!0,this.food&&(this.food.filter((function(e){-1!=e.foodName.indexOf(t.value)&&t.data.push(e)})),this.$nextTick((function(){t.scroll?(console.log("更新滚动条"),t.scroll.refresh()):t.scroll=new t.$BScroll(t.$refs.queryScroll,{click:!0,bounce:!1})})),setTimeout((function(){t.isLoading=!1}),250))},clearStorage:function(){var t=this;this.$confirm({title:"提示",message:"确定清空搜索记录吗?"}).then((function(){localStorage.removeItem("shop_storage"),t.stroage=null})).catch((function(){}))}}),created:function(){var t=this;window.onresize=function(){return function(){t.f_height=document.body.clientHeight}()},this.food?this.getCart():this.query(),JSON.parse(localStorage.getItem("shop_storage"))&&(this.stroage=JSON.parse(localStorage.getItem("shop_storage")))},computed:Object(n["a"])({},Object(h["d"])(["food"])),watch:{value:function(t){var e=this;if(!t)return this.data=[];this.getSearchFood(),this.timer||(this.timer=setTimeout((function(){var o=JSON.parse(localStorage.getItem("shop_storage"));o?-1===o.indexOf(t)&&(e.value&&o.unshift(e.value),localStorage.shop_storage=JSON.stringify(o)):e.value&&(localStorage.shop_storage=JSON.stringify([e.value])),e.stroage=JSON.parse(localStorage.getItem("shop_storage")),e.timer=null}),1e3))},food:{handler:function(t){var e=[];return t.forEach((function(t){t.foodNumber>=1&&e.push(t)})),this.$store.commit("setFoodList",e)},deep:!0},f_height:function(){this.t_height>this.f_height?this.fot_falg=!1:this.fot_falg=!0}}},v=f,p=(o("78b8"),o("2877")),g=Object(p["a"])(v,a,s,!1,null,"42c05ec9",null);e["default"]=g.exports},"653e":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"shopCart"}},[o("div",{staticClass:"s-box clearfix"},[o("div",{staticClass:"left fl"},[o("div",{staticClass:"sl-box",on:{click:t.handelClick}},[o("svg",{staticClass:"icon s-icon",attrs:{"aria-hidden":"true"}},[o("use",{attrs:{"xlink:href":"#icon-gouwuche"}})]),o("van-badge",{directives:[{name:"show",rawName:"v-show",value:t.foodLength,expression:"foodLength"}],staticClass:"shop-badge v-badge",attrs:{content:t.foodLength,max:"99"}})],1),t.foodLength?o("span",{staticClass:"price"},[t._v(t._s("￥"+t.totalPrice))]):o("span",{staticClass:"msg"},[t._v(" 购物车空空如也呢！ ")])]),o("div",{staticClass:"s-sub fr",on:{click:t.goPay}},[t._v("去结算")])]),o("van-popup",{attrs:{position:"bottom",id:"shop-popup"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticClass:"s-header"},[o("h1",{staticClass:"sh-msg"},[t._v("已选商品")]),o("div",{on:{click:t.clearShopCart}},[o("svg",{staticClass:"icon clear-icon",attrs:{"aria-hidden":"true"}},[o("use",{attrs:{"xlink:href":"#icon-gouwuche"}})]),o("span",[t._v("清空购物车")])])]),o("div",{ref:"cart",staticClass:"cart"},[o("div",{staticClass:"content111"},[o("food-item",{attrs:{food:t.foodList,setStyle:"s-food-item"}})],1)])])],1)},s=[],i=o("5530"),n=o("2f62"),r=o("92fe"),c={components:{"food-item":r["a"]},data:function(){return{show:!1}},methods:{goPay:function(){if(this.foodLength)return this.$router.push("/pay")},handelClick:function(){if(!this.foodLength)return this.$toast("购物车中还没有商品哦");this.show=!0},clearShopCart:function(){this.$store.commit("clearShopCart"),this.show=!1}},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(n["d"])(["foodList","totalPrice","token","takeway"])),Object(n["b"])(["foodLength"])),{},{listData:function(){return this.$store.state.foodList}}),watch:{listData:function(t){if(0===t.length)return this.show=!1}}},l=c,u=(o("bea5"),o("2877")),d=Object(u["a"])(l,a,s,!1,null,"75191f5c",null);e["a"]=d.exports},"6d9e":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("van-number-keyboard",{attrs:{id:"num-keyword",show:t.key_flag,title:"标题","extra-key":"清空","close-button-text":"完成","z-index":"100000"},on:{blur:t.onHide,input:t.onInput,delete:t.onDelete}})},s=[],i=(o("fb6a"),o("a9e3"),o("d3b7"),o("25f0"),{props:{key_flag:{type:Boolean},item:{type:Object}},data:function(){return{vt_ipt:""}},mounted:function(){var t=this;this.$nextTick((function(){var e='<h2 class="vt-msg" style="text-align: center;width: 12%;font-size:16px;font-weight:700;">数量</h2>\n      <div class="vt-ipt" style="box-sizing:border-box; height:1.7rem; line-height:1.7rem; border-radius:3px;margin-left:8px;margin-right:6px;padding:0 10px;width:67%;background-color:#fff;"></div>\n      <div class="vt-sub" style="cursor: pointer;padding:7px 12px;;font-size: 0.8rem;background-color: #fff;border-radius: 0.2rem;">确认</div>',o=document.querySelector(".van-number-keyboard__header");o.innerHTML=e,document.querySelector(".vt-sub").addEventListener("click",(function(e){t.vt_ipt?t.item.foodNumber=Number(t.vt_ipt):t.item.foodNumber=0,t.onHide()}))}))},methods:{onInput:function(t){var e=this.vt_ipt;if(e+=t,!(Number(e)>999)){this.vt_ipt=e;var o=document.querySelector(".vt-ipt");return o.innerHTML=this.vt_ipt,"清空"==t?(this.vt_ipt="",void this.setValue()):void 0}this.$toast("最高填写数量为999")},setValue:function(){var t=document.querySelector(".vt-ipt");t.innerHTML=this.vt_ipt},onDelete:function(t){var e=this.vt_ipt.toString();this.vt_ipt=e.slice(0,e.length-1),this.setValue()},onHide:function(){this.vt_ipt="",this.setValue(),this.$emit("onHide",!1)}}}),n=i,r=o("2877"),c=Object(r["a"])(n,a,s,!1,null,null,null);e["a"]=c.exports},"78b8":function(t,e,o){"use strict";o("8c76")},"857a":function(t,e,o){var a=o("1d80"),s=/"/g;t.exports=function(t,e,o,i){var n=String(a(t)),r="<"+e;return""!==o&&(r+=" "+o+'="'+String(i).replace(s,"&quot;")+'"'),r+">"+n+"</"+e+">"}},"8c76":function(t,e,o){},9911:function(t,e,o){"use strict";var a=o("23e7"),s=o("857a"),i=o("af03");a({target:"String",proto:!0,forced:i("link")},{link:function(t){return s(this,"a","href",t)}})},"9e53":function(t,e,o){},af03:function(t,e,o){var a=o("d039");t.exports=function(t){return a((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},b0e1:function(t,e,o){},bea5:function(t,e,o){"use strict";o("b0e1")},d968:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"nav"},[o("div",{staticClass:"b"},[o("van-icon",{staticClass:"nav-arrow-left",attrs:{name:"arrow-left"},on:{click:t.navigator}}),o("div",{staticClass:"nav-title"},[t._v(t._s(t.title))])],1)])},s=[],i=(o("ac1f"),o("5319"),o("9911"),{props:["title","link","location_search_id"],methods:{navigator:function(){"/"===this.link?this.$router.go(-1):"/index"===this.link?this.location_search_id?this.$router.replace({path:"/index"+this.location_search_id}):this.$router.replace({path:"/index",query:{shop_id:this.$store.state.shopId}}):"/mine"===this.link?this.$router.replace(this.link):this.$router.go(-1)}}}),n=i,r=(o("00df"),o("2877")),c=Object(r["a"])(n,a,s,!1,null,"93c629b4",null);e["a"]=c.exports}}]);