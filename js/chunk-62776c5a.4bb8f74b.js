(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62776c5a"],{"120d":function(t,e,s){"use strict";s("17b5")},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"17b5":function(t,e,s){},"1e4b":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"index"}},[t.shop_flag?[s("div",{ref:"header",style:t.takeway?t.header_styleObject:"",attrs:{id:"header"}},[t.takeway?s("div",{ref:"take",staticClass:"takeway-header"},[s("div",{staticClass:"u-addess"},[t.header_flag?[s("div",{staticClass:"address"},[s("div",[s("router-link",{attrs:{to:"/checkAddress"}},["定位失败"===t.address?s("svg",{staticClass:"icon add-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-dingwei"}})]):s("svg",{staticClass:"icon add-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-dingwei1"}})]),s("div",{staticClass:"addressName van-ellipsis"},[t._v(t._s(t.address))]),s("van-icon",{staticClass:"arrow-right",attrs:{name:"arrow"}})],1)],1)]),s("div",{staticClass:"user",on:{click:function(e){return t.$alert({title:"2",message:"用户"})}}},[s("van-icon",{staticClass:"icon-user",attrs:{name:"manager"}})],1)]:[s("div",{staticClass:"f_header"},[s("van-icon",{staticClass:"nav-arrow-left",attrs:{name:"arrow-left"},on:{click:function(e){return t.$router.replace("/home")}}}),s("h2",[t._v(t._s(t.shopName))])],1)]],2),s("van-notice-bar",{attrs:{scrollable:!1,text:"特惠：满15减5、满20减10、满30减20"}}),s("banner",{attrs:{bannerList:t.bannerList}})],1):s("div",{ref:"t_header",staticClass:"t-header"},[s("div",{staticClass:"tab-item",class:{"tab-item-active":0===t.tabIndex},on:{click:function(e){return t.check(0)}}},[t._v(" 点餐 ")]),s("div",{staticClass:"tab-item",class:{"tab-item-active":t.tabIndex},on:{click:function(e){return t.check(1)}}},[t._v(" 订单 ")])])]),s("div",{ref:"content",staticClass:"s_content",class:{o_content:t.tabIndex,take_content:t.takeway},style:t.takeway?t.content_styleObject:""},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.tabIndex,expression:"!tabIndex"}],staticClass:"index clearfix"},[s("div",{ref:"menuScroll",staticClass:"d_cate fl"},[s("ul",{staticClass:"menu"},t._l(t.Food,(function(e,a){return s("li",{key:e.key,staticClass:"menu-item",class:{"menu-item-acitve":a===t.currentIndex},on:{click:function(e){return t.handelClick(a)}}},[s("a",{attrs:{href:"javascript:void(0);"}},[s("p",[t._v(t._s(e.food_type_name))]),s("div",t._l(e.iconArr,(function(e,a){return s("span",{key:a,domProps:{innerHTML:t._s(e)}})})),0)]),s("van-badge",{directives:[{name:"show",rawName:"v-show",value:t.reNum(e.listArray),expression:"reNum(item.listArray)"}],staticClass:"v-badge",attrs:{content:t.reNum(e.listArray),max:"99"}})],1)})),0)]),s("div",{staticClass:"d_food_list fr"},[s("div",{staticClass:"food-card-header clearfix"},[s("div",{staticClass:"menu-title fl clearfix"},[s("div",{staticClass:"title fl van-ellipsis"},[s("span",[t._v(t._s(t.menuTitle?t.menuTitle.food_type_name:""))])])]),s("div",{staticClass:"search fr",on:{click:function(e){return t.$router.push("/query")}}},[s("svg",{staticClass:"icon search-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-sousuo"}})]),s("span",[t._v("搜索")])])]),s("div",{ref:"foodScroll",attrs:{id:"food"}},[s("div",{staticClass:"wrapper"},t._l(t.Food,(function(e,a){return s("div",{key:a,staticClass:"foodBox",style:a===t.Food.length-1?t.food_styleObject:""},[s("div",{staticClass:"food-item-title"},[0!==a?[s("span",{staticClass:"food-title"},[t._v(t._s(e.food_type_name))]),t._l(e.iconArr,(function(e,a){return s("span",{key:a,domProps:{innerHTML:t._s(e)}})}))]:t._e()],2),s("food-item",{attrs:{food:e.listArray},on:{handelFocus:t.showKey}})],1)})),0)])])]),t.takeway?t._e():[s("order",{directives:[{name:"show",rawName:"v-show",value:t.tabIndex,expression:"tabIndex"}]})]],2),s("key-board",{attrs:{key_flag:t.show,item:t.item},on:{onHide:t.closeKey}}),s("shop-cart",{directives:[{name:"show",rawName:"v-show",value:!t.tabIndex,expression:"!tabIndex"}]})]:[t.takeway?s("Skeleton"):t._e()],t.isLoading?s("loading"):t._e()],2)},r=[],i=(s("4de4"),s("7db0"),s("4160"),s("c975"),s("fb6a"),s("b0c0"),s("a9e3"),s("d3b7"),s("ac1f"),s("3ca3"),s("841c"),s("159b"),s("ddb0"),s("2b3d"),s("96cf"),s("1da1")),n=s("5530"),o=s("bf93"),c=s("6d9e"),l=s("653e"),d=s("92fe"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"orderScroll",staticClass:"order"},[t.flag?s("div",{staticClass:"empty"},[s("h1",[t._v("没有数据")])]):s("div",{staticClass:"wrapper"},t._l(t.order_list,(function(e){return s("div",{key:e.orderId,staticClass:"order-item",on:{click:function(s){return t.orderDetail(e.orderId)}}},[s("div",{staticClass:"order-item-header clearfix"},[s("div",{staticClass:"fl shop-order"},[s("span",{staticClass:"os-name van-ellipsis"},[t._v(t._s(e.shopName+"—"+e.tableNumber))]),s("span",{staticClass:"os-time van-ellipsis"},[t._v(t._s(t._f("dateFormat")(e.orderTime)))])]),s("div",{staticClass:"fr order-status"},["holdPay"===e.orderStatus?s("span",[t._v("未支付")]):s("span",[t._v("订单状态未知")])])]),s("div",{staticClass:"o-centent"},[s("ul",t._l(e.orderMessage,(function(e,a){return s("li",{key:a,staticClass:"food-item clearfix"},[s("div",{staticClass:"food-info fl"},[s("p",{staticClass:"food-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"food-num"},[t._v(t._s(e.num))])]),s("p",{staticClass:"food-price fr"},[t._v(t._s("￥"+e.foodPice+"元"))])])})),0)]),s("div",{staticClass:"order-item-fotter clearfix"},[s("p",{staticClass:"order-item-msg fr"},[t._v(" 共"+t._s(e.orderMessage.length)+"件商品，实付:￥"+t._s(e.orderPice)+"元 ")])])])})),0)])},h=[],f={data:function(){return{flag:!1,query_info:{tableNumber:"测试2号桌",shopId:"00b6e25446304622afc76b9cb1493063",pageStr:"0"},order_list:[]}},methods:{queryOrder:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a in s=new URLSearchParams,t.query_info)s.append(a,t.query_info[a]);return e.next=4,t.$http.post("/user/postSelectAllOrderByOrderUserId",s);case 4:r=e.sent,i=r.data,"000000"===i.messageStatus&&(t.order_list=i.listArray.reverse(),t.$nextTick((function(){t.scroll?t.scroll.refresh():t.scroll=new t.$BScroll(t.$refs.orderScroll,{click:!0})})));case 7:case"end":return e.stop()}}),e)})))()},orderDetail:function(t){this.$router.push({path:"/detail",query:{o_id:t}})}},created:function(){this.queryOrder()},computed:{tabIndex:function(){return this.$store.state.tabIndex}},watch:{tabIndex:function(t){console.log("哈哈哈哈哈哈"),t&&this.queryOrder()}}},p=f,v=(s("25ff"),s("2877")),m=Object(v["a"])(p,u,h,!1,null,"855fc32a",null),g=m.exports,y=s("2f62"),_=s("5c4c"),b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"index-skeleton"},[t._m(0),s("div",{staticClass:"container"},[s("div",{staticClass:"left"},[s("ul",t._l(10,(function(e,a){return s("li",{key:a},[t._m(1,!0)])})),0)]),s("div",{staticClass:"right"},[s("div",{staticClass:"cart-header"}),s("div",{staticClass:"food"},t._l(8,(function(e,a){return s("div",{key:e,staticClass:"item"},[s("div",{staticClass:"avatar"}),t._m(2,!0)])})),0)])])])},C=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header-skeleton"},[s("div",{staticClass:"header"},[s("div",{staticClass:"left"}),s("div",{staticClass:"right"})]),s("div",{staticClass:"notice-bar"},[s("div",{staticClass:"txt"})]),s("div",{staticClass:"banner"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a",{attrs:{href:"javascript:void(0);"}},[s("span")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info"},[s("div",{staticClass:"food-info"},[s("p",{staticClass:"name"}),s("p",{staticClass:"msg"})]),s("div",{staticClass:"price"},[s("div",{staticClass:"f-price"}),s("div",{staticClass:"btn-group"})])])}],w={data:function(){return{}}},x=w,k=(s("641a"),Object(v["a"])(x,b,C,!1,null,"3339c563",null)),S=k.exports,I={components:{foodItem:d["a"],Banner:_["a"],shopCart:l["a"],order:g,loading:o["a"],keyBoard:c["a"],Skeleton:S},data:function(){return{header_styleObject:{transform:"",transition:"0.2s linear",opacity:""},content_styleObject:{transform:"",transition:"0.2s linear"},food_styleObject:{"margin-bottom":"0","min-height":""},ffflag:!0,isLoading:!0,show:!1,item:{},vt_ipt:"",scrollY:0,listHeight:[],activeKey:0,Food:[],bannerList:[],ScrollClient:0,address:"定位中...",shop_flag:!1,header_flag:!1,lng:"",lat:""}},methods:Object(n["a"])(Object(n["a"])({checkAddress:function(){console.log(1)}},Object(y["c"])(["checkTab","setMethod","setAddress","setpositionFlag","setShopId","set_All_foodList","set_shopName"])),{},{check:function(t){var e=this;t!==this.tabIndex&&(this.checkTab(t),t||this.$nextTick((function(){e.calcFoodHeight(),e.scroll.refresh(),e.menuScroll.refresh()})))},getCart:function(){var t=this;if(localStorage.Allcart&&"[]"!==localStorage.Allcart){var e=JSON.parse(localStorage.Allcart),s=e.find((function(e){return e.id==t.shopId}));if(s){var a=s.list,r=[];a.filter((function(t){return r.push(t.foodId)})),this.$store.state.foodList=e,this.Food.forEach((function(t){t.listArray&&t.listArray.forEach((function(t){-1!=r.indexOf(t.foodId)&&(t.foodNumber=a[r.indexOf(t.foodId)].foodNumber)}))}))}}},handelClick:function(t){var e=this.$refs.foodScroll.querySelectorAll(".foodBox");this.scroll.scrollToElement(e[t],200)},showMsg:function(){this.$alert({title:"公告",message:"公告:有问题可咨询客服1999999999999 (微信同号) !"})},reNum:function(t){if(t){var e=0;return t.filter((function(t){t.foodNumber&&(e+=Number(t.foodNumber))})),e}},closeKey:function(t){this.show=t},showKey:function(t){console.log(t),this.item=t,this.show=!0},calcFoodHeight:function(){var t=this;this.shop_flag&&this.$nextTick((function(){var e=t.$refs.foodScroll.querySelectorAll(".foodBox"),s=0;t.listHeight.push(s);for(var a=0;a<e.length;a++)s+=e[a].clientHeight,t.listHeight.push(s)}))},query:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new URLSearchParams,s.append("shopId",t.shopId),s.append("userToken",""),e.next=5,t.$http.post("/user/postSelectFoodAndTypeByUserInShop",s);case 5:a=e.sent,r=a.data,"999999"===r.messageStatus?(t.shop_flag=!1,t.$toast("店铺已下架")):(t.shop_flag=!0,t.Food=r,t.set_shopName(t.Food[0].shopName),localStorage.cart&&(t.getCart(),t.$store.commit("totalPrice")),t.$nextTick((function(){t.scroll=new t.$BScroll(t.$refs.foodScroll,{probeType:3,click:!0,bounce:{top:!1}}),t.menuScroll=new t.$BScroll(t.$refs.menuScroll,{click:!0}),t.scroll.on("scroll",(function(e){if(t.scrollY=Math.abs(Math.round(e.y)),t.takeway){var s=t.$refs.header.clientHeight,a=(10-Math.ceil(t.scrollY/(s/10)))/10;t.scrollY<s-s/2?(t.header_styleObject.transform="translatey(-".concat(t.scrollY,"px)"),t.header_styleObject.opacity=a+.1,t.content_styleObject.transform="translatey(-".concat(t.scrollY,"px)")):(t.header_styleObject.transform="translatey(-".concat(s,"px)"),t.header_styleObject.opacity=0,t.content_styleObject.transform="translatey(-".concat(s,"px)"))}})),t.tabIndex||t.calcFoodHeight()}))),t.isLoading=!1;case 9:case"end":return e.stop()}}),e)})))()},queryBanner:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new URLSearchParams,s.append("shopId",t.shopId),e.next=4,t.$http.post("/user/postSelectAdvertisementByUser",s);case 4:a=e.sent,r=a.data,"000000"===r.messageStatus&&(i=0,r.listArray.forEach((function(t){t.advertisementPicPath||i++})),i<3&&(t.bannerList=r.listArray));case 7:case"end":return e.stop()}}),e)})))()},getLocation:function(){var t=this,e=new AMap.Geolocation({enableHighAccuracy:!0});e.getCurrentPosition((function(e,s){if("complete"==e){t.setpositionFlag(!0);var a={lng:s.position.lng,lat:s.position.lat};t.getAddress(a)}else t.getCurrentCityPostion()}))},getAddress:function(t){var e=this,s=t.lng+","+t.lat,a=new AMap.Geocoder({city:e.city,radius:500,extensions:"all"});a.getAddress(s,(function(s,a){if(console.log(a,s),"complete"===s&&a.regeocode){var r=a.regeocode,i={initPosition:{}};if(r.aois.length){var n=r.aois[0];e.address=n.name,i.initPosition.lng=n.location.lng,i.initPosition.lat=n.location.lat,i.addressName=n.name}else{var o=r.addressComponent.township,c=r.formattedAddress,l=c.indexOf(o);l+=o.length;var d=c.slice(l);e.address=d,i.addressName=d,i.initPosition.lng=t.lng,i.initPosition.lat=t.lat}if(i.initPosition.province=r.addressComponent.province,i.initPosition.city=r.addressComponent.city,i.initPosition.district=r.addressComponent.district,r.pois.length){var u=r.pois.slice(1,6);i.pois=u}localStorage.setItem("param",JSON.stringify(i)),e.setAddress(i)}}))},getCurrentCityPostion:function(){var t=this,e=setInterval(Object(i["a"])(regeneratorRuntime.mark((function s(){var a,r,i,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!t.$store.state.city){s.next=9;break}return clearInterval(e),a=new URLSearchParams,a.append("shopAddressCity",t.$store.state.city),s.next=6,t.$http.post("/user/postSelectShopCoordinateByCity",a);case 6:r=s.sent,i=r.data,"000000"===i.messageStatus&&(n={lng:i.phone_x,lat:i.phone_y},t.getAddress(n));case 9:case"end":return s.stop()}}),s)}))),100)},IsRangeAllow:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new URLSearchParams,s.append("shopId",t.shopId),s.append("phone_x",t.shopId),s.append("phone_y",t.shopId),e.next=6,t.$http.post("/user/postIsRangeAllow",s);case 6:a=e.sent,a.data;case 8:case"end":return e.stop()}}),e)})))()}}),created:function(){this.setShopId(this.$route.query.shop_id),this.$store.state.location_search=location.search,this.$route.query.type&&(this.header_flag=!0),this.shopId=this.$route.query.shop_id,this.takeway&&(this.queryBanner(),this.header_flag&&("{}"!==JSON.stringify(this.initAddress)?this.initAddress.address?this.address=this.initAddress.address:this.initAddress.addressName?this.address=this.initAddress.addressName:this.address="定位失败,请选择收货地址":this.getLocation())),this.food_styleObject["min-height"]=document.documentElement.clientHeight+"px"},computed:Object(n["a"])(Object(n["a"])({menuTitle:function(){if(this.Food)return this.Food[this.activeKey]}},Object(y["d"])(["foodList","tabIndex","takeway","initAddress","city","shopName"])),{},{currentIndex:function(){for(var t=0;t<this.listHeight.length;t++){var e=this.listHeight[t],s=this.listHeight[t+1];if(this.scrollY>=e&&this.scrollY<s){if(this.activeKey!==t){this.activeKey=t;var a=document.querySelectorAll(".menu-item")[t],r=a.clientHeight,i=Math.round(a.getBoundingClientRect().bottom),n=Math.round(a.getBoundingClientRect().top),o=document.documentElement.clientHeight;this.takeway||(n-=this.$refs.t_header.clientHeight),this.ScrollClient<=a.offsetTop?o-i<5*r&&this.menuScroll.scrollBy(0,-r,800):n<4*r&&(n>0&&t>3?this.menuScroll.scrollBy(0,r,500):this.menuScroll.scrollTo(0,0,500)),this.ScrollClient=a.offsetTop}return t}}}}),watch:{Food:{handler:function(t){var e=[];return t.forEach((function(t){t.listArray&&t.listArray.forEach((function(t){t.foodNumber>=1&&e.push(t)}))})),this.$store.commit("setFoodList",e)},deep:!0}},destroyed:function(){this.scroll&&(this.scroll.destroy(),this.menuScroll.destroy())},beforeRouteEnter:function(t,e,s){s((function(t){t.query()}))},beforeRouteLeave:function(t,e,s){"/home"===t.path&&this.$store.commit("setFood",null),s()}},A=I,$=(s("120d"),Object(v["a"])(A,a,r,!1,null,"2d15aa2e",null));e["default"]=$.exports},"25ff":function(t,e,s){"use strict";s("484d")},"484d":function(t,e,s){},"5c4c":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.bannerList.length>0?s("div",[s("van-swipe",{attrs:{height:125,"indicator-color":"white",autoplay:3e3}},[t._l(t.bannerList,(function(e,a){return[e.advertisementPicPath?s("van-swipe-item",{key:a},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.advertisementPicPath,expression:"item.advertisementPicPath"}],staticStyle:{width:"100%",height:"100%"}})]):t._e()]}))],2)],1):t._e()},r=[],i={props:{bannerList:{type:Array}}},n=i,o=s("2877"),c=Object(o["a"])(n,a,r,!1,null,null,null);e["a"]=c.exports},"641a":function(t,e,s){"use strict";s("ab73")},"841c":function(t,e,s){"use strict";var a=s("d784"),r=s("825a"),i=s("1d80"),n=s("129f"),o=s("14c3");a("search",1,(function(t,e,s){return[function(e){var s=i(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,s):new RegExp(e)[t](String(s))},function(t){var a=s(e,t,this);if(a.done)return a.value;var i=r(t),c=String(this),l=i.lastIndex;n(l,0)||(i.lastIndex=0);var d=o(i,c);return n(i.lastIndex,l)||(i.lastIndex=l),null===d?-1:d.index}]}))},ab73:function(t,e,s){}}]);